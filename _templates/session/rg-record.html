{% extends "_base.html" %} {% block statics %}
<link
	rel="stylesheet"
	href="/static/css/session/rg-record.css"
/>
{% endblock statics %} {% block contents %}
<h2 class="mb-3">Respiratory Graph</h2>
<div class="card rounded-3 mb-0">
	<div class="card-body">
		<div class="d-flex flex-row align-items-center justify-content-center">
			<div class="card-body">
				<div class="block">
					<div class="d-flex justify-content-center">
						<input
							type="range"
							class="form-control-range vertical-slider"
							step="0.1"
							id="slider"
							orient="vertical"
						/>
					</div>
					<div class="d-flex justify-content-around my-3">
						<button
							class="btn btn-primary"
							id="startStopButton"
						>
							Start Recording
						</button>

						{% if not user.is_authenticated %}
						<p class="text-danger">Sign in to save recording</p>
						{% else %}
						<a
							role="button"
							href="{% url 'session:rg-inquiry' user.username %}"
							class="btn btn-secondary"
							>My Recordings</a
						>
						{% endif %}
					</div>
					<div class="d-flex justify-content-center">
						<h4 id="stopwatch">0.00</h4>
					</div>
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div
			class="modal fade"
			id="staticBackdrop"
			data-bs-backdrop="static"
			data-bs-keyboard="false"
			tabindex="-1"
			aria-labelledby="staticBackdropLabel"
			aria-hidden="true"
		>
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h1
							class="modal-title fs-5"
							id="staticBackdropLabel"
						>
							Meditation Finished
						</h1>
						<button
							type="button"
							class="btn-close"
							data-bs-dismiss="modal"
							aria-label="Close"
						></button>
					</div>
					<div class="modal-body">
						<p class="fw-bold mt-2">Respiration Chart</p>
						<div class="w-auto h-auto">
							<canvas
								class="col-1"
								id="plotting-modal"
							></canvas>
						</div>
						<form
							id="csv-form"
							method="POST"
						>
							{% csrf_token %}
							<input
								type="text"
								id="csvInput"
								name="csv_input"
								style="display: none"
							/>
							<p class="fw-bold mt-2">Notes for this meditation (optional)</p>
							<textarea
								class="form-control"
								id="noteInput"
								name="note_input"
								rows="3"
							></textarea>
						</form>
					</div>
					<div class="modal-footer">
						<button
							class="btn btn-primary"
							id="saveButton"
							form="csv-form"
							type="submit"
							disabled="true"
						>
							Save Recording
						</button>
						<button
							type="button"
							class="btn btn-danger"
							data-bs-dismiss="modal"
						>
							Discard
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	{% endblock contents %} {% block scripts %}
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="/static/js/session/rg-record.js"></script>
	{% endblock %}
</div>
